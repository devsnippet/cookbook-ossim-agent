# ossim agent configuration file
#
# /etc/ossim/agent/config.cfg
#
# Generated by Chef for <%= node[:fqdn] %>
#


[control-framework]

# enable the control framework
enable = <%= node[:ossim][:control_framework] %>

# define the unique ID of this agent
#id = "aegis"
id = <%= node[:hostname] %>

<% if node[:ossim][:control_framework] == "True" %>
# define the host:port of the frameworkd instance
ip = <%= node[:ossim][:frameworkd][:server_ip] %>
port = <%= node[:ossim][:frameworkd][:server_port] %>
<% end %>


# general
#
[daemon]
daemon = True
pid = /var/run/ossim-agent.pid


[log]
file = /var/log/ossim/agent.log
error = /var/log/ossim/agent_error.log
stats = /var/log/ossim/agent_stats.log

# uncomment this line if you want to log to a remote syslog
# remember you need to startup syslog with the -r option to enable 
# the facility to receive messages from the network
#syslog = localhost

# verbose level
#
# these are the levels allowed by agent:
# debug, info, warning, error and critical
#
# you can use the -v and -vv command line
# arguments to increse this verbose level
verbose = info

# default values, can be overriden in each plugin rule
[plugin-defaults]
sensor = 127.0.0.1
interface = any
date_format = %Y-%m-%d %H:%M:%S ; format, not date itself
ossim_dsn=mysql:localhost:ossim:root:yoursecretpassword
tzone=0
ctx=

[watchdog]
enable = True
interval = 180         ; seconds between checks
restart_interval=3600 ; seconds between plugin process restart


# output
#

# write events into a plain file (server injectable)
[output-plain]
enable = False
file = /var/log/ossim/agent-plain.log

# send events and receive/send control messages from/to server
[output-server]
enable = True
ip = <%=  node[:ossim][:server] %>
port = <%= node[:ossim][:port] %>
send_events = True


[output-idm]
enable=True
ip=127.0.0.1
port=40002

# plugins
# (list of plugins to be loaded)
#
[plugins]

# detectors
#
#apache=/etc/ossim/agent/plugins/apache.cfg
#arpwatch=/etc/ossim/agent/plugins/arpwatch.cfg
#cisco-ids=/etc/ossim/agent/plugins/cisco-ids.cfg
#cisco-pix=/etc/ossim/agent/plugins/cisco-pix.cfg
#cisco-router=/etc/ossim/agent/plugins/cisco-router.cfg
#cisco-vpn=/etc/ossim/agent/plugins/cisco-vpn.cfg
#cisco-ips=/etc/ossim/agent/plugins/cisco-ips.cfg
#clamav=/etc/ossim/agent/plugins/clamav.cfg
#clurgmgr=/etc/ossim/agent/plugins/clurgmgr.cfg
#fw1ngr60=/etc/ossim/agent/plugins/fw1ngr60.cfg
#gfi=/etc/ossim/agent/plugins/gfi.cfg
#heartbeat=/etc/ossim/agent/plugins/heartbeat.cfg
#iis=/etc/ossim/agent/plugins/iis.cfg
#intrushield=/etc/ossim/agent/plugins/intrushield.cfg
#iphone=/etc/ossim/agent/plugins/iphone.cfg
#iptables=/etc/ossim/agent/plugins/iptables.cfg
#kismet=/etc/ossim/agent/plugins/kismet.cfg
#mwcollect=/etc/ossim/agent/plugins/mwcollect.cfg
#nagios=/etc/ossim/agent/plugins/nagios.cfg
#netgear=/etc/ossim/agent/plugins/netgear.cfg
#netscreen-manager=/etc/ossim/agent/plugins/netscreen-manager.cfg
#netscreen-nsm=/etc/ossim/agent/plugins/netscreen-nsm.cfg
#netscreen-firewall=/etc/ossim/agent/plugins/netscreen-firewall.cfg
#ntsyslog=/etc/ossim/agent/plugins/ntsyslog.cfg
#osiris=/etc/ossim/agent/plugins/osiris.cfg
#ossec=/etc/ossim/agent/plugins/ossec.cfg
#ossim-agent=/etc/ossim/agent/plugins/ossim-agent.cfg
#p0f=/etc/ossim/agent/plugins/p0f.cfg
#pads=/etc/ossim/agent/plugins/pads.cfg
#pam_unix=/etc/ossim/agent/plugins/pam_unix.cfg
#postfix=/etc/ossim/agent/plugins/postfix.cfg
#radiator=/etc/ossim/agent/plugins/radiator.cfg
#realsecure=/etc/ossim/agent/plugins/realsecure.cfg
#rrd=/etc/ossim/agent/plugins/rrd.cfg
#snortunified=/etc/ossim/agent/plugins/snortunified.cfg
#spamassassin=/etc/ossim/agent/plugins/spamassassin.cfg
#squid=/etc/ossim/agent/plugins/squid.cfg
#symantec-ams=/etc/ossim/agent/plugins/symantec-ams.cfg
#ssh=/etc/ossim/agent/plugins/ssh.cfg
#stonegate=/etc/ossim/agent/plugins/stonegate.cfg
#sudo=/etc/ossim/agent/plugins/sudo.cfg
#syslog=/etc/ossim/agent/plugins/syslog.cfg
#snare=/etc/ossim/agent/plugins/snare.cfg
#tarantella=/etc/ossim/agent/plugins/tarantella.cfg
#fidelis=/etc/ossim/agent/plugins/fidelis.cfg
#rsa-secureid=/etc/ossim/agent/plugins/rsa-secureid.cfg
#cisco-acs=/etc/ossim/agent/plugins/cisco-acs.cfg
#fortiguard=/etc/ossim/agent/plugins/fortiguard.cfg

# monitors
#
#wmi-monitor=/etc/ossim/agent/plugins/wmi-monitor.cfg
#nmap=/etc/ossim/agent/plugins/nmap-monitor.cfg
#ntop=/etc/ossim/agent/plugins/session-monitor.cfg
#opennms=/etc/ossim/agent/plugins/opennms-monitor.cfg
#ossim-ca=/etc/ossim/agent/plugins/ossim-monitor.cfg
#ping=/etc/ossim/agent/plugins/ping-monitor.cfg
#tcptrack=/etc/ossim/agent/plugins/tcptrack-monitor.cfg
#nessus=/etc/ossim/agent/plugins/nessus-monitor.cfg
#whois=/etc/ossim/agent/plugins/whois-monitor.cfg
#malwaredomainlist=/etc/ossim/agent/plugins/malwaredomainlist.cfg


# detectors
#
default[:ossim][:plugins] = { :apache => { :enable => false, :path => /etc/ossim/agent/plugins/apache.cfg } }
default[:ossim][:plugins] = { :arpwatch => { :enable => false, :path => /etc/ossim/agent/plugins/arpwatch.cfg } }
default[:ossim][:plugins] = { :cisco-ids => { :enable => false, :path => /etc/ossim/agent/plugins/cisco-ids.cfg } }
default[:ossim][:plugins] = { :cisco-pix => { :enable => false, :path => /etc/ossim/agent/plugins/cisco-pix.cfg } }
default[:ossim][:plugins] = { :cisco-router => { :enable => false, :path => /etc/ossim/agent/plugins/cisco-router.cfg } }
default[:ossim][:plugins] = { :cisco-vpn => { :enable => false, :path => /etc/ossim/agent/plugins/cisco-vpn.cfg } }
default[:ossim][:plugins] = { :cisco-ips => { :enable => false, :path => /etc/ossim/agent/plugins/cisco-ips.cfg } }
default[:ossim][:plugins] = { :clamav => { :enable => false, :path => /etc/ossim/agent/plugins/clamav.cfg } }
default[:ossim][:plugins] = { :clurgmgr => { :enable => false, :path => /etc/ossim/agent/plugins/clurgmgr.cfg } }
default[:ossim][:plugins] = { :fw1ngr60 => { :enable => false, :path => /etc/ossim/agent/plugins/fw1ngr60.cfg } }
default[:ossim][:plugins] = { :gfi => { :enable => false, :path => /etc/ossim/agent/plugins/gfi.cfg } }
default[:ossim][:plugins] = { :heartbeat => { :enable => false, :path => /etc/ossim/agent/plugins/heartbeat.cfg } }
default[:ossim][:plugins] = { :iis => { :enable => false, :path => /etc/ossim/agent/plugins/iis.cfg } }
default[:ossim][:plugins] = { :intrushield => { :enable => false, :path => /etc/ossim/agent/plugins/intrushield.cfg } }
default[:ossim][:plugins] = { :iphone => { :enable => false, :path => /etc/ossim/agent/plugins/iphone.cfg } }
default[:ossim][:plugins] = { :iptables => { :enable => false, :path => /etc/ossim/agent/plugins/iptables.cfg } }
default[:ossim][:plugins] = { :kismet => { :enable => false, :path => /etc/ossim/agent/plugins/kismet.cfg } }
default[:ossim][:plugins] = { :mwcollect => { :enable => false, :path => /etc/ossim/agent/plugins/mwcollect.cfg } }
default[:ossim][:plugins] = { :nagios => { :enable => false, :path => /etc/ossim/agent/plugins/nagios.cfg } }
default[:ossim][:plugins] = { :netgear => { :enable => false, :path => /etc/ossim/agent/plugins/netgear.cfg } }
default[:ossim][:plugins] = { :netscreen-manager => { :enable => false, :path => /etc/ossim/agent/plugins/netscreen-manager.cfg } }
default[:ossim][:plugins] = { :netscreen-nsm => { :enable => false, :path => /etc/ossim/agent/plugins/netscreen-nsm.cfg } }
default[:ossim][:plugins] = { :netscreen-firewall => { :enable => false, :path => /etc/ossim/agent/plugins/netscreen-firewall.cfg } }
default[:ossim][:plugins] = { :ntsyslog => { :enable => false, :path => /etc/ossim/agent/plugins/ntsyslog.cfg } }
default[:ossim][:plugins] = { :osiris => { :enable => false, :path => /etc/ossim/agent/plugins/osiris.cfg } }
default[:ossim][:plugins] = { :ossec => { :enable => false, :path => /etc/ossim/agent/plugins/ossec.cfg } }
default[:ossim][:plugins] = { :ossim-agent => { :enable => false, :path => /etc/ossim/agent/plugins/ossim-agent.cfg } }
default[:ossim][:plugins] = { :p0f => { :enable => false, :path => /etc/ossim/agent/plugins/p0f.cfg } }
default[:ossim][:plugins] = { :pads => { :enable => false, :path => /etc/ossim/agent/plugins/pads.cfg } }
default[:ossim][:plugins] = { :pam_unix => { :enable => false, :path => /etc/ossim/agent/plugins/pam_unix.cfg } }
default[:ossim][:plugins] = { :postfix => { :enable => false, :path => /etc/ossim/agent/plugins/postfix.cfg } }
default[:ossim][:plugins] = { :radiator => { :enable => false, :path => /etc/ossim/agent/plugins/radiator.cfg } }
default[:ossim][:plugins] = { :realsecure => { :enable => false, :path => /etc/ossim/agent/plugins/realsecure.cfg } }
default[:ossim][:plugins] = { :rrd => { :enable => false, :path => /etc/ossim/agent/plugins/rrd.cfg } }
default[:ossim][:plugins] = { :snortunified => { :enable => false, :path => /etc/ossim/agent/plugins/snortunified.cfg } }
default[:ossim][:plugins] = { :spamassassin => { :enable => false, :path => /etc/ossim/agent/plugins/spamassassin.cfg } }
default[:ossim][:plugins] = { :squid => { :enable => false, :path => /etc/ossim/agent/plugins/squid.cfg } }
default[:ossim][:plugins] = { :symantec-ams => { :enable => false, :path => /etc/ossim/agent/plugins/symantec-ams.cfg } }
default[:ossim][:plugins] = { :ssh => { :enable => false, :path => /etc/ossim/agent/plugins/ssh.cfg } }
default[:ossim][:plugins] = { :stonegate => { :enable => false, :path => /etc/ossim/agent/plugins/stonegate.cfg } }
default[:ossim][:plugins] = { :sudo => { :enable => false, :path => /etc/ossim/agent/plugins/sudo.cfg } }
default[:ossim][:plugins] = { :syslog => { :enable => false, :path => /etc/ossim/agent/plugins/syslog.cfg } }
default[:ossim][:plugins] = { :snare => { :enable => false, :path => /etc/ossim/agent/plugins/snare.cfg } }
default[:ossim][:plugins] = { :tarantella => { :enable => false, :path => /etc/ossim/agent/plugins/tarantella.cfg } }
default[:ossim][:plugins] = { :fidelis => { :enable => false, :path => /etc/ossim/agent/plugins/fidelis.cfg } }
default[:ossim][:plugins] = { :rsa-secureid => { :enable => false, :path => /etc/ossim/agent/plugins/rsa-secureid.cfg } }
default[:ossim][:plugins] = { :cisco-acs => { :enable => false, :path => /etc/ossim/agent/plugins/cisco-acs.cfg } }
default[:ossim][:plugins] = { :fortiguard => { :enable => false, :path => /etc/ossim/agent/plugins/fortiguard.cfg } }

# monitors
#
default[:ossim][:plugins] = { :wmi-monitor => { :enable => false, :path => /etc/ossim/agent/plugins/wmi-monitor.cfg } }
default[:ossim][:plugins] = { :nmap => { :enable => false, :path => /etc/ossim/agent/plugins/nmap-monitor.cfg } }
default[:ossim][:plugins] = { :ntop => { :enable => false, :path => /etc/ossim/agent/plugins/session-monitor.cfg } }
default[:ossim][:plugins] = { :opennms => { :enable => false, :path => /etc/ossim/agent/plugins/opennms-monitor.cfg } }
default[:ossim][:plugins] = { :ossim-ca => { :enable => false, :path => /etc/ossim/agent/plugins/ossim-monitor.cfg } }
default[:ossim][:plugins] = { :ping => { :enable => false, :path => /etc/ossim/agent/plugins/ping-monitor.cfg } }
default[:ossim][:plugins] = { :tcptrack => { :enable => false, :path => /etc/ossim/agent/plugins/tcptrack-monitor.cfg } }
default[:ossim][:plugins] = { :nessus => { :enable => false, :path => /etc/ossim/agent/plugins/nessus-monitor.cfg } }
default[:ossim][:plugins] = { :whois => { :enable => false, :path => /etc/ossim/agent/plugins/whois-monitor.cfg } }
default[:ossim][:plugins] = { :malwaredomainlist => { :enable => false, :path => /etc/ossim/agent/plugins/malwaredomainlist.cfg } }
